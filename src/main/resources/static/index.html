<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashlink - URL Shortener</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [url, setUrl] = useState('');
            const [loading, setLoading] = useState(false);
            const [result, setResult] = useState(null);
            const [error, setError] = useState('');
            const [history, setHistory] = useState([]);

            const handleSubmit = async (e) => {
                e.preventDefault();
                setLoading(true);
                setError('');
                setResult(null);

                try {
                    const response = await fetch('/api/shorten', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ longUrl: url }),
                    });

                    if (!response.ok) {
                        throw new Error('Invalid URL format. Please use a valid HTTP/HTTPS URL.');
                    }

                    const data = await response.json();
                    const shortUrl = `${window.location.origin}/${data.shortCode}`;
                    
                    setResult({
                        shortCode: data.shortCode,
                        shortUrl: shortUrl,
                        longUrl: url,
                        createdAt: data.createdAt
                    });
                    
                    setHistory(prev => [data, ...prev.slice(0, 4)]);
                    setUrl('');
                } catch (err) {
                    setError(err.message);
                } finally {
                    setLoading(false);
                }
            };

            const copyToClipboard = async (text) => {
                try {
                    await navigator.clipboard.writeText(text);
                    // You could add a toast notification here
                } catch (err) {
                    console.error('Failed to copy:', err);
                }
            };

            return (
                <div className="min-h-screen flex flex-col">
                    {/* Header */}
                    <header className="bg-white shadow-sm border-b border-gray-200">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center space-x-3">
                                    <i className="fas fa-link text-blue-600 text-2xl"></i>
                                    <h1 className="text-2xl font-bold text-gray-900">Flashlink</h1>
                                </div>
                                <p className="text-gray-600 hidden sm:block">Fast, reliable URL shortening</p>
                            </div>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="flex-grow">
                        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                            {/* Hero Section */}
                            <div className="text-center mb-12">
                                <h2 className="text-4xl font-bold text-gray-900 mb-4">
                                    Shorten Your URLs in a Flash
                                </h2>
                                <p className="text-xl text-gray-600 max-w-2xl mx-auto">
                                    Transform long, cumbersome URLs into short, shareable links with our powerful URL shortening service.
                                </p>
                            </div>

                            {/* URL Shortener Form */}
                            <div className="bg-white rounded-2xl shadow-xl p-8 mb-8">
                                <form onSubmit={handleSubmit} className="space-y-6">
                                    <div>
                                        <label htmlFor="url" className="block text-sm font-medium text-gray-700 mb-2">
                                            Enter your long URL
                                        </label>
                                        <div className="flex space-x-4">
                                            <input
                                                type="url"
                                                id="url"
                                                value={url}
                                                onChange={(e) => setUrl(e.target.value)}
                                                placeholder="https://www.example.com/very/long/url"
                                                className="flex-grow px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition"
                                                required
                                                pattern="^https?://.*"
                                            />
                                            <button
                                                type="submit"
                                                disabled={loading || !url}
                                                className="px-8 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition"
                                            >
                                                {loading ? (
                                                    <span className="flex items-center">
                                                        <i className="fas fa-spinner fa-spin mr-2"></i>
                                                        Shortening...
                                                    </span>
                                                ) : (
                                                    <span className="flex items-center">
                                                        <i className="fas fa-compress-alt mr-2"></i>
                                                        Shorten
                                                    </span>
                                                )}
                                            </button>
                                        </div>
                                    </div>

                                    {error && (
                                        <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg">
                                            <i className="fas fa-exclamation-circle mr-2"></i>
                                            {error}
                                        </div>
                                    )}
                                </form>
                            </div>

                            {/* Result Display */}
                            {result && (
                                <div className="bg-green-50 border border-green-200 rounded-2xl p-8 mb-8">
                                    <div className="flex items-center justify-between mb-4">
                                        <h3 className="text-lg font-semibold text-green-800">
                                            <i className="fas fa-check-circle mr-2"></i>
                                            URL Shortened Successfully!
                                        </h3>
                                    </div>
                                    
                                    <div className="space-y-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Short URL</label>
                                            <div className="flex items-center space-x-2">
                                                <input
                                                    type="text"
                                                    value={result.shortUrl}
                                                    readOnly
                                                    className="flex-grow px-4 py-2 bg-white border border-gray-300 rounded-lg"
                                                />
                                                <button
                                                    onClick={() => copyToClipboard(result.shortUrl)}
                                                    className="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition"
                                                >
                                                    <i className="fas fa-copy"></i>
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Original URL</label>
                                            <input
                                                type="text"
                                                value={result.longUrl}
                                                readOnly
                                                className="w-full px-4 py-2 bg-white border border-gray-300 rounded-lg"
                                            />
                                        </div>
                                        
                                        <div className="text-sm text-gray-600">
                                            <i className="fas fa-clock mr-1"></i>
                                            Created: {new Date(result.createdAt).toLocaleString()}
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* History */}
                            {history.length > 0 && (
                                <div className="bg-white rounded-2xl shadow-xl p-8">
                                    <h3 className="text-lg font-semibold text-gray-900 mb-4">
                                        <i className="fas fa-history mr-2"></i>
                                        Recent Short URLs
                                    </h3>
                                    <div className="space-y-3">
                                        {history.map((item, index) => (
                                            <div key={index} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <div className="flex-grow">
                                                    <div className="font-medium text-gray-900">
                                                        {window.location.origin}/{item.shortCode}
                                                    </div>
                                                    <div className="text-sm text-gray-600 truncate">
                                                        Created: {new Date(item.createdAt).toLocaleString()}
                                                    </div>
                                                </div>
                                                <button
                                                    onClick={() => copyToClipboard(`${window.location.origin}/${item.shortCode}`)}
                                                    className="px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition"
                                                >
                                                    <i className="fas fa-copy"></i>
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    </main>

                    {/* Footer */}
                    <footer className="bg-white border-t border-gray-200">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                            <div className="text-center text-gray-600">
                                <p>&copy; 2024 Flashlink. Built with Spring Boot & React.</p>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
